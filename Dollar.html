<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dollar Hisab</title>

  <style>
    :root{
      /* ‚úÖ LIGHT + COLORFUL THEME */
      --bg:#f7f9ff;
      --bg2:#ffffff;

      --surface:#ffffff;
      --surface2:#f3f6ff;

      --line: rgba(15,23,42,.10);
      --line2: rgba(15,23,42,.14);

      --text: #0f172a;
      --muted: rgba(15,23,42,.62);

      --brand:#4f46e5;     /* indigo */
      --brand2:#22c55e;    /* green */
      --pink:#ec4899;
      --violet:#8b5cf6;
      --orange:#f59e0b;
      --cyan:#06b6d4;
      --sky:#38bdf8;
      --bad:#ef4444;

      --r14:14px;
      --r18:18px;

      --topbar-h: 74px;
      --sb-w: 288px;

      --shadow: 0 18px 55px rgba(15,23,42,.12);
      --shadow2: 0 10px 26px rgba(15,23,42,.10);

      --glass: rgba(255,255,255,.72);
      --glass2: rgba(255,255,255,.92);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family:'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1100px 520px at 12% 0%, rgba(79,70,229,.20), transparent 58%),
        radial-gradient(900px 520px at 95% 18%, rgba(56,189,248,.20), transparent 55%),
        radial-gradient(950px 620px at 60% 100%, rgba(34,197,94,.16), transparent 55%),
        radial-gradient(900px 520px at 10% 92%, rgba(236,72,153,.12), transparent 60%),
        linear-gradient(180deg, #fbfcff, #eef2ff 55%, #f9fbff);
      overflow-x:hidden;
    }

    /* subtle noise */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      pointer-events:none;
      opacity:.045;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
      mix-blend-mode: multiply;
    }

    /* =====================================================
       ‚úÖ NEW: Page Loading Overlay + Highlight after load
       (Old table/card loader removed)
       ===================================================== */
    #pageLoader{
      position: fixed;
      inset: 0;
      z-index: 20000;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 20px;
      background:
        radial-gradient(900px 520px at 15% 10%, rgba(79,70,229,.20), transparent 55%),
        radial-gradient(900px 520px at 90% 20%, rgba(6,182,212,.18), transparent 55%),
        radial-gradient(900px 520px at 50% 95%, rgba(34,197,94,.16), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.88), rgba(255,255,255,.78));
      backdrop-filter: blur(14px);
      border-bottom: 1px solid rgba(15,23,42,.08);
    }
    .loader-card{
      width: min(520px, 95%);
      background: rgba(255,255,255,.92);
      border: 1px solid rgba(15,23,42,.10);
      box-shadow: 0 18px 60px rgba(15,23,42,.14);
      border-radius: 20px;
      padding: 22px 18px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .loader-card::before{
      content:"";
      position:absolute;
      inset:-80px -80px auto auto;
      width:220px;height:220px;
      border-radius:999px;
      background: linear-gradient(135deg, rgba(79,70,229,.22), rgba(6,182,212,.18), rgba(34,197,94,.16));
      opacity:.9;
      transform: rotate(18deg);
    }
    .loader-card > *{ position:relative; z-index:1; }
    .loader-title{
      margin: 0 0 6px 0;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: .2px;
      background: linear-gradient(90deg, #4f46e5, #06b6d4, #22c55e);
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
    }
    .loader-sub{
      margin: 0 0 14px 0;
      color: rgba(15,23,42,.68);
      font-weight: 800;
      font-size: 12px;
    }
    .ring{
      width: 46px; height: 46px;
      border-radius: 50%;
      border: 4px solid rgba(15,23,42,.10);
      border-top-color: #4f46e5;
      animation: spin 1s linear infinite;
      margin: 0 auto 14px auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Fade-in highlight for main content after load */
    .cards-container,
    .show-box,
    .page-size-area,
    .row-line-show{
      opacity: 1;
      transform: none;
      transition: opacity .35s ease, transform .35s ease;
    }
    body.is-loading .cards-container,
    body.is-loading .show-box,
    body.is-loading .page-size-area,
    body.is-loading .row-line-show{
      opacity: 0;
      transform: translateY(8px);
      pointer-events: none;
    }
    body.is-loaded .card{
      animation: popIn .45s ease both;
    }
    body.is-loaded .transaction-item{
      animation: rowIn .35s ease both;
    }
    @keyframes popIn{
      from{ transform: translateY(8px); filter: saturate(.95); }
      to{ transform: translateY(0); filter: saturate(1); }
    }
    @keyframes rowIn{
      from{ opacity: 0; transform: translateY(6px); }
      to{ opacity: 1; transform: translateY(0); }
    }
    /* ===================================================== */

    /* ===== Navbar ===== */
    .navbar{
      height: var(--topbar-h);
      position: fixed;
      inset: 0 0 auto 0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 0 14px;
      z-index: 80;
      backdrop-filter: blur(16px);
      background:
        linear-gradient(180deg, rgba(255,255,255,.86), rgba(255,255,255,.70));
      border-bottom: 1px solid var(--line);
    }

    .nav-inner{
      width: min(1040px, 100%);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .menu-icon{
      width: 46px;
      height: 46px;
      border-radius: 16px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
      background: rgba(255,255,255,.92);
      border: 1px solid rgba(15,23,42,.10);
      box-shadow: var(--shadow2);
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
      font-size: 20px;
      color: #0f172a;
      position: relative;
      overflow:hidden;
    }
    .menu-icon::after{
      content:"";
      position:absolute;
      inset:-40px -40px auto auto;
      width:120px;height:120px;
      border-radius:999px;
      background: linear-gradient(135deg, rgba(79,70,229,.25), rgba(56,189,248,.18), rgba(34,197,94,.18));
      filter: blur(0px);
      transform: rotate(18deg);
      opacity:.9;
    }
    .menu-icon > *{ position:relative; z-index:1; }
    .menu-icon:hover{
      background: #ffffff;
      border-color: rgba(79,70,229,.25);
      transform: translateY(-1px);
    }
    .menu-icon:active{ transform: scale(.98); }

    .nav-title{
      display:flex;
      flex-direction:column;
      align-items:center;
      line-height:1.1;
      gap: 2px;
    }
    .nav-title h1{
      margin:0;
      font-size: 18px;
      font-weight: 900;
      letter-spacing: .3px;
      background: linear-gradient(90deg, #4f46e5, #06b6d4, #22c55e);
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
    }
    .nav-title small{
      color: var(--muted);
      font-weight: 800;
      font-size: 11px;
    }

    .nav-badge{
      display:flex;
      align-items:center;
      gap:8px;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.92);
      border: 1px solid rgba(15,23,42,.10);
      box-shadow: var(--shadow2);
      font-size: 12px;
      color: rgba(15,23,42,.72);
      white-space: nowrap;
      position: relative;
      overflow:hidden;
    }
    .nav-badge::before{
      content:"";
      position:absolute;
      inset:auto -30px -30px auto;
      width:120px;height:120px;
      border-radius:999px;
      background: linear-gradient(135deg, rgba(236,72,153,.18), rgba(245,158,11,.16), rgba(79,70,229,.14));
      opacity:.9;
    }
    .nav-badge > *{ position:relative; z-index:1; }

    .dot{
      width: 8px; height: 8px; border-radius: 999px;
      background: var(--brand2);
      box-shadow: 0 0 0 6px rgba(34,197,94,.14);
    }

    /* ===== Sidebar (colorful) ===== */
    .sidebar{
      position: fixed;
      top: var(--topbar-h);
      left: calc(-1 * var(--sb-w));
      width: var(--sb-w);
      height: calc(100% - var(--topbar-h));
      padding: 14px 12px;
      z-index: 70;
      transition: .28s ease;
      background:
        linear-gradient(180deg, rgba(255,255,255,.92), rgba(245,247,255,.92));
      border-right: 1px solid rgba(15,23,42,.10);
      box-shadow: 0 18px 60px rgba(15,23,42,.14);
      backdrop-filter: blur(14px);
    }
    .sidebar.open{ left: 0; }

    .sb-card{
      border-radius: 18px;
      padding: 14px;
      background: linear-gradient(135deg, rgba(79,70,229,.14), rgba(56,189,248,.12), rgba(34,197,94,.10));
      border: 1px solid rgba(79,70,229,.16);
      box-shadow: var(--shadow2);
      margin-bottom: 12px;
      position: relative;
      overflow: hidden;
    }
    .sb-card::after{
      content:"";
      position:absolute;
      right:-60px; top:-60px;
      width:160px; height:160px;
      border-radius:999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.85), rgba(255,255,255,0));
    }
    .sb-card h3{
      margin:0;
      font-size: 14px;
      font-weight: 900;
      letter-spacing: .2px;
      position:relative;
      z-index:1;
    }
    .sb-card p{
      margin:6px 0 0 0;
      color: rgba(15,23,42,.70);
      font-size: 12px;
      line-height:1.4;
      position:relative;
      z-index:1;
      font-weight: 700;
    }

    .sidebar a{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 12px 12px;
      margin: 8px 2px;
      border-radius: 16px;
      color: #0f172a;
      text-decoration:none;
      font-size: 14px;
      font-weight: 900;
      background: rgba(255,255,255,.92);
      border: 1px solid rgba(15,23,42,.10);
      box-shadow: 0 10px 18px rgba(15,23,42,.08);
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
      position: relative;
      overflow:hidden;
    }
    .sidebar a::before{
      content:"";
      position:absolute;
      left:0; top:0; bottom:0;
      width: 4px;
      background: linear-gradient(180deg, #4f46e5, #06b6d4, #22c55e);
      opacity:.85;
    }
    .sidebar a::after{
      content:"";
      position:absolute;
      inset:auto -70px -70px auto;
      width:160px;height:160px;
      border-radius:999px;
      background: linear-gradient(135deg, rgba(236,72,153,.14), rgba(245,158,11,.12), rgba(79,70,229,.10));
      opacity:.9;
      transform: rotate(-10deg);
    }
    .sidebar a > *{ position:relative; z-index:1; }
    .sidebar a:hover{
      background: #ffffff;
      border-color: rgba(79,70,229,.22);
      transform: translateY(-1px);
    }

    /* Main content */
    .main-content {
      margin-top: 30px;
      padding: 20px;
    }

    /* Grid layout */
    .cards-container {
      display: grid;
      gap: 15px;
    }

    /* =====================================================
       ‚úÖ ONLY CHANGE: Card Color + Design Updated
       (No other code changed)
       ===================================================== */
    .card {
      position: relative;
      border-radius: 16px;
      padding: 18px 16px;
      text-align: center;

      /* modern glassy look */
      border: 1px solid rgba(255,255,255,.35);
      box-shadow: 0 12px 30px rgba(15,23,42,.10);
      overflow: hidden;
      transform: translateZ(0);

      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
    }

    /* subtle shine */
    .card::before{
      content:"";
      position:absolute;
      inset:-60px -60px auto auto;
      width: 180px;
      height: 180px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), rgba(255,255,255,0) 70%);
      opacity: .8;
      transform: rotate(18deg);
      pointer-events:none;
    }
    /* bottom glow */
    .card::after{
      content:"";
      position:absolute;
      inset:auto -80px -90px -80px;
      height: 160px;
      background: radial-gradient(circle at 50% 40%, rgba(255,255,255,.30), rgba(255,255,255,0) 70%);
      opacity: .7;
      pointer-events:none;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 18px 44px rgba(15,23,42,.14);
      filter: saturate(1.05);
    }

    .small-p {
      font-size: 14px!important;
      color: rgba(255,255,255,.92)!important;
      opacity: .92;
      letter-spacing: .2px;
    }

    .card h3 {
      margin-top: 0px;
      font-size: 14px;
      color: rgba(255,255,255,.92);
      font-weight: 800;
      text-align: center;
      text-transform: none;
      position: relative;
      z-index: 1;
    }

    .card p {
      margin: 2px 0;
      font-size: 20px;
      font-weight: 900;
      color: #ffffff;
      line-height: 1.1;
      position: relative;
      z-index: 1;
      text-shadow: 0 2px 10px rgba(0,0,0,.18);
    }

    /* Small screens */
    @media (max-width: 768px) {
      .cards-container {
        grid-template-columns: repeat(2, 1fr);
      }

      .card {
        min-height: 100px;
        max-height: 100px;
        padding: 6px 6px;
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        border-radius: 14px;
      }

      .card h3 {
        font-size: 10px;
        margin: 0;
        order: 2;
      }

      .card p {
        font-size: 12px;
        margin: 0;
        order: 1;
        line-height: 1.1;
      }

      .card1 p { font-size: 25px; line-height: 2; }
      .card2 p { font-size: 25px; line-height: 2; }
      .card3 p { font-size: 25px; }
      .card4 p { font-size: 25px; }
      .card5 p { font-size: 25px; }
      .card6 p { font-size: 25px; }
      .card7 p { font-size: 25px; }
      .card8 p { font-size: 25px; }
      .card9 p { font-size: 25px; line-height: 2; }

      /* keep your balance highlight */
      .card1 p { color: #f0c413; }
      .card1 h3 { color: rgba(240,196,19,.95); }
    }

    /* Updated colorful gradients (premium) */
    .card1 { background: linear-gradient(135deg, #0b1220, #0f172a, #111827); }
    .card2 { background: linear-gradient(135deg, #ef4444, #db2777, #7c3aed); }
    .card3 { background: linear-gradient(135deg, #f59e0b, #f97316, #ea580c); }
    .card4 { background: linear-gradient(135deg, #4f46e5, #06b6d4, #22c55e); }
    .card5 { background: linear-gradient(135deg, #0ea5e9, #2563eb, #1d4ed8); }
    .card6 { background: linear-gradient(135deg, #22c55e, #16a34a, #15803d); }
    .card7 { background: linear-gradient(135deg, #8b5cf6, #6366f1, #4f46e5); }
    .card8 { background: linear-gradient(135deg, #f43f5e, #ef4444, #b91c1c); }
    .card9 { background: linear-gradient(135deg, #334155, #0f172a, #020617); }
    /* ===================================================== */

    /* ‚úÖ ‡¶∏‡¶Ç‡¶∂‡ßã‡¶ß‡¶ø‡¶§ CSS: ‡¶¨‡ßã‡¶§‡¶æ‡¶Æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞‡¶≠‡¶æ‡¶¨‡ßá ‡¶è‡¶ï ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶Ü‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø */
    .cash-buttons {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin: 15px 20px 20px 20px;
    }

    .cash-buttons button {
      border: none;
      border-radius: 8px;
      font-size: 10px;
      font-weight: bold;
      cursor: pointer;
      color: white;
      transition: 0.5s;
      padding: 10px 0;
      flex-grow: 1;
      min-width: 0;
    }

    .cash-in-btn { background-color: #28a745; }
    .cash-in-btn:hover { background-color: #218838; }

    .cash-out-btn { background-color: #dc3545; }
    .cash-out-btn:hover { background-color: #b02a37; }

    .c-convert { background-color: #17a2b8; }
    .c-convert:hover { background-color: #138496; }

    .taka-transfar { background-color: #de901b; }
    .taka-transfar:hover { background-color: #ca8018; }

    @media (max-width: 768px) {
      .cash-buttons button { font-size: 11px; }
    }

    /* ‚úÖ ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ popup form */
    .popup-form {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      padding-top: 0px;
      z-index: 9999;
    }

    .form-content {
      background: #fff;
      padding: 25px 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      text-align: center;
      animation: popupFade 0.3s ease;
    }

    .form-contents {
      background: #fff;
      padding: 25px 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      text-align: center;
      animation: popupFade 0.3s ease;
    }

    @keyframes popupFade {
      from { transform: scale(0.9); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .form-content input,
    .form-content select,
    .form-contents input,
    .form-contents select,
    .form-content textarea,
    .form-contents textarea {
      display: block;
      width: 80%;
      margin: 10px auto;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 15px;
    }

    #formt-out .row-line-type select {
      width: 49%;
      display: inline-block;
      margin: 10px 0;
    }

    #formConvert .row-line-type select {
      width: 49%;
      display: inline-block;
      margin: 10px 0;
    }

    .form-content button,
    .form-contents button {
      margin-top: 12px;
      padding: 8px 20px;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      color: white;
      background-color: #007bff;
      transition: 0.3s;
    }

    .form-content h1,
    .form-contents h1 {
      margin-bottom: 15px;
      font-size: 20px;
      padding: 20px 25px;
    }
    .dollarintext { color : green; }
    .dollarouttext { color : red; }
    .cashouttext { color : #de901b; }
    .converttext { color : #17a2b8; }

    .form-content button:hover,
    .form-contents button:hover {
      background-color: #0056b3;
    }

    .row-line-type {
      display: flex;
      align-items: center;
      margin-top: 10px;
      gap: 100px;
      justify-content: center;
    }
    .account-type-a {
      width: 200px!important;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .account-type-b {
      width: 200px!important;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    .row-line-time{
      display: flex;
      align-items: center;
      margin-top: 10px;
      justify-content: center;
    }

    .date-box, .time-box { position: relative; overflow: hidden; }

    .date-box {
      width: 200px!important;
      display: flex;
      align-items: center;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin-left: auto;
      margin-right: -3px;
      gap: 40px;
    }

    .time-box {
      width: 200px;
      display: flex;
      align-items: center;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      gap: 70px;
    }

    .hidden-picker {
      opacity: 0;
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      cursor: pointer;
      display: block !important;
    }

    .date-box .icon { width: 35px; cursor: pointer; z-index: 10; }
    .time-box .icon { width: 28px; cursor: pointer; z-index: 10; }

    .row-line-ratbox {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 15px;
      width: 85%;
      margin: 15px auto 0 auto;
      justify-content: flex-start;
    }

    .row-line-ratbox label {
      padding: 0;
      margin-right: -2px;
      font-weight: 600;
      color: #333;
      font-size: 16px;
    }

    .row-line-ratbox label:nth-child(3) { margin-left: 20px; }

    .dollar-input-container,
    .rate-input-container {
      position: relative;
      display: flex;
      align-items: center;
    }

    .dollar-box {
      height: 65px;
      padding: 8px 30px 8px 10px;
      font-size: 20px !important;
      width: 130px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .rate-box {
      height: 65px;
      padding: 8px 30px 8px 10px;
      font-size: 20px !important;
      width: 160px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .currency-symbol {
      position: absolute;
      right: 10px;
      font-size: 16px;
      font-weight: bold;
      color: #555;
      pointer-events: none;
    }

    .row-line-charge-box {
      display: flex;
      gap: 8px;
      align-items: center;
      margin: 15px auto 0 auto;
      width: 85%;
      justify-content: flex-start;
    }

    .row-line-charge-box label {
      padding: 0;
      margin-right: -2px;
      font-weight: 600;
      color: #333;
      font-size: 16px;
    }

    .charge-box {
      height: 65px;
      padding: 8px 10px;
      font-size: 20px !important;
      width: 95px!important;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .row-line-charge-box label:nth-child(3) { margin-left: 10px; }

    .total-box {
      height: 65px;
      padding: 8px 10px;
      font-size: 20px !important;
      width: 170px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
      text-align: right;
      font-weight: bold;
      color: #007bff;
    }

    .row-line-convert-taka {
      display: flex;
      align-items: center;
      gap: 15px;
      width: 85%;
      margin: 15px auto 10px auto;
      justify-content: center;
    }

    .row-line-convert-taka label {
      font-weight: 600;
      color: #333;
      font-size: 16px;
      margin-right: -5px;
    }

    #formConvert .tk-convert {
      height: 65px;
      padding: 8px 10px;
      font-size: 20px !important;
      width: 100px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin: 0;
    }

    #formConvert .charge-box {
      width: 80px !important;
      margin: 0;
    }

    .taka-total-box {
      height: 65px;
      padding: 8px 10px;
      font-size: 20px !important;
      width: 80%;
      max-width: 300px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
      text-align: right;
      font-weight: bold;
      color: #007bff;
      display: flex;
      align-items: center;
      line-height: 1;
      justify-content: flex-end;
      margin: 5px auto 15px auto;
    }

    #formt-out input[type="number"],
    #formt-out input[type="text"] {
      width: 80%;
      margin: 5px auto;
    }

    #formt-out .tk-transfer-amount {
      height: 65px;
      padding: 8px 10px;
      font-size: 20px !important;
      width: 80%;
      max-width: 300px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin: 10px auto;
    }

    .taka-amount-label {
      display: block;
      width: 80%;
      max-width: 300px;
      margin: 15px auto 0 auto;
      font-weight: 600;
      color: #333;
      font-size: 16px;
      text-align: left;
    }

    #formIn #inDescription { margin-top: 10px; }

    .button-row {
      display: flex;
      justify-content: space-between;
      width: 100%;
      margin-top: 15px;
    }
    .cancel-btn {
      background: #ff4d4d !important;
      color: white;
      padding: 12px 20px;
      font-size: 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 35%;
      font-weight: bold;
      box-shadow: 0 3px 5px rgba(0,0,0,0.2);
      margin-right: 60px;
    }
    .save-btn {
      background: #007bff !important;
      color: white;
      padding: 12px 20px;
      font-size: 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      width: 35%;
      font-weight: bold;
      box-shadow: 0 3px 5px rgba(0,0,0,0.2);
    }
    .cancel-btn:hover { background: #e63939; }
    .save-btn:hover { background: #0063cc; }

    .show-box {
      padding: 0px;
      height: auto;
      width: 95%;
      max-width: 580px;
      margin: 15px auto 0 auto;
      border-radius: 10px;
      background-color: #ffffff;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      font-size: 18px;
      font-weight: bold;
      color: #00796b;
      text-align: center;
      overflow-x: auto;
      overflow-y: visible;
    }

    .table-wrapper {
      display: block;
      border-collapse: collapse;
      width: 100%;
      border-radius: 8px;
      position: relative;
    }

    .transaction-table-header,
    #transactionBody {
      display: table-row-group;
      height: auto !important;
      max-height: none;
      overflow-y: visible;
    }

    .transaction-table-header {
      background-color: #1a4e69;
      color: #fff;
      font-size: 14px;
      font-weight: bold;
      z-index: 9;
      border-radius: 10px 10px 0 0;
    }

    /* ‚úÖ UPDATED: More spacing (‡¶´‡¶æ‡¶Å‡¶ï ‡¶´‡¶æ‡¶Å‡¶ï) */
    .transaction-table-header div,
    .transaction-item div {
      display: table-cell;
      padding: 14px 14px;              /* ‡¶Ü‡¶ó‡ßá 12px 10px ‡¶õ‡¶ø‡¶≤ */
      white-space: nowrap;
      vertical-align: middle;
      height: 34px;
      letter-spacing: .25px;           /* ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶´‡¶æ‡¶Å‡¶ï */
    }

    .transaction-item {
      display: table-row;
      font-size: 14px;
      color: #000;
      border-bottom: 1px solid #ddd;
    }

    .transaction-item:nth-child(even) { background-color: #e9ecef; }
    .transaction-item:nth-child(odd) { background-color: #ffffff; }

    /* ‚úÖ UPDATED: Serial column added (‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶Ü‡¶ó‡ßá) */
    .th-serial, .td-serial { width: 40px; min-width: 40px; font-size: 12px; text-align:center; font-weight:900; }
    .th-date, .td-date { width: 60px; min-width: 60px; font-size: 12px; }
    .th-time, .td-time { width: 50px; min-width: 50px; font-size: 12px; }
    .th-category, .td-category { width: 80px; min-width: 80px; font-size: 12px; }
    .th-account, .td-account { width: 80px; min-width: 80px; font-size: 12px; }
    .th-bank, .td-bank { width: 80px; min-width: 80px; font-size: 12px; }
    .th-number, .td-number { width: 80px; min-width: 80px; font-size: 12px; }
    .th-charge, .td-charge { width: 50px; min-width: 50px; text-align: right; font-size: 12px;}
    .th-rate, .td-rate { width: 50px; min-width: 50px; text-align: right; font-size: 12px;}
    .th-dollar, .td-dollar { width: 60px; min-width: 60px; text-align: right; font-size: 12px;}
    .th-amount, .td-amount { width: 70px; min-width: 70px; text-align: right; font-weight: bold; font-size: 12px;}
    .th-profit-loss, .td-profit-loss {
      width: 70px;
      min-width: 70px;
      text-align: right;
      font-weight: bold;
      font-size: 12px;
    }
    .th-details, .td-details { width: auto; min-width: 150px; white-space: normal; text-align: left; font-size: 12px;}
    .th-action, .td-action { width: 70px; min-width: 70px; }

    .amount-in { color: green; }
    .amount-out { color: red; }

    .transaction-item:hover { background: #f8f8f8; }

    .action-buttons {
      display: flex;
      gap: 6px;
      align-items: center;
      justify-content: center;
    }

    .action-buttons button {
      border: none;
      padding: 5px 8px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 12px;
    }

    .edit-btn { background: #007bff; color: #fff; }
    .delete-btn { background: #dc3545; color: #fff; }

    .page-size-area {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      margin: 10px auto 20px auto;
      width: 95%;
      max-width: 580px;
      box-sizing: border-box;
      background-color: #ffffff;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .pagination-controls {
      text-align: left;
      padding: 0;
      margin: 0;
      display: flex;
      gap: 3px;
      flex-wrap: wrap;
    }

    .pagination-controls .page-link {
      display: inline-block;
      padding: 5px 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      text-decoration: none;
      color: #444;
      font-size: 14px;
      transition: all 0.2s ease;
      cursor: pointer;
      min-width: 15px;
      text-align: center;
    }

    .pagination-controls .page-link.active-page {
      background-color: #007bff !important;
      color: white !important;
      border-color: #007bff !important;
      font-weight: bold !important;
      transform: scale(1.05) !important;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2) !important;
      cursor: default;
    }

    .pagination-controls .page-link.active-page:hover,
    .pagination-controls .page-link.active-page:focus {
      background-color: #007bff !important;
      color: white !important;
    }

    .pagination-controls .page-link:hover:not(.active-page) { background-color: #e9ecef; }

    .pagination-controls .page-link.disabled-nav {
      color: #ccc !important;
      background-color: #f7f7f7 !important;
      border-color: #ddd !important;
      cursor: default;
      pointer-events: none;
    }

    .ellipsis { padding: 5px 4px; color: #888; font-size: 14px; }

    .row-line-show {
      display: flex;
      align-items: center;
      margin-top: 10px;
      height: 70px;
    }

    .date-boxs {
      height: 45px;
      width: 80px!important;
      background-color: #e9f542;
      margin-left: 20px;
      margin-right: 1px;
      align-items: center;
      border-radius: 4px;
      align-items: center;
      display: flex;
      justify-content: center;
    }

    #clearDateBtn {
      background: none;
      border: 1px solid red;
      color: red;
      border-radius: 4px;
      font-size: 14px;
      padding: 4px 8px;
      cursor: pointer;
      line-height: 1;
      margin: 0;
      transition: background-color 0.2s;
    }
    #clearDateBtn:hover { background-color: rgba(255, 0, 0, 0.1); }

    .cg-select {
      background-color: #a5f57f;
      margin-left: 25px;
      border-radius: 4px;
      font-size: 12px;
      width: 150px!important;
      height: 45px;
      align-items: center;
    }

    .cash-select {
      background-color: skyblue;
      margin-left: 10px;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 14px;
      height: 45px;
      width: 180px;
      align-items: center;
    }

    .table-rejalt {
      background-color: #ccc297;
      display: flex;
      margin-left: 20px;
      margin-right: 15px;
      border-radius: 4px;
      font-size: 14px;
      height: 45px;
      width: 200px;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    #toggleColumnsBtn {
      height: 45px;
      width: 80px;
      background-color: #007bff;
      color: white;
      border: none;
      margin-left: 20px;
      margin-right: 20px;
      border-radius: 6px;
      cursor: pointer;
    }

    .column-dropdown {
      display: none;
      position: absolute;
      top: 45px;
      right: 10px;
      background-color: #fff;
      border: 1px solid #ddd;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      border-radius: 6px;
      padding: 10px;
      z-index: 1000;
      min-width: 150px;
      text-align: left;
    }

    .column-dropdown label {
      display: block;
      font-size: 14px;
      color: #333;
      padding: 5px 0;
      cursor: pointer;
      font-weight: normal;
    }

    .column-dropdown input[type="checkbox"] { margin-right: 8px; }

    /* ‚úÖ UPDATED: Column count increased (Serial added => total 14 columns) */
    .hidden-col-1 div:nth-child(1),
    .hidden-col-2 div:nth-child(2),
    .hidden-col-3 div:nth-child(3),
    .hidden-col-4 div:nth-child(4),
    .hidden-col-5 div:nth-child(5),
    .hidden-col-6 div:nth-child(6),
    .hidden-col-7 div:nth-child(7),
    .hidden-col-8 div:nth-child(8),
    .hidden-col-9 div:nth-child(9),
    .hidden-col-10 div:nth-child(10),
    .hidden-col-11 div:nth-child(11),
    .hidden-col-12 div:nth-child(12),
    .hidden-col-13 div:nth-child(13),
    .hidden-col-14 div:nth-child(14)
    {
      display: none !important;
    }

    .page-size-control {
      font-size: 14px;
      color: #444;
      margin: 0;
    }

    .page-size-control select {
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
      margin-left: 5px;
      font-size: 14px;
    }

    /* old loader-small kept but not used anymore */
    .loader-small {
      border: 2px solid #f3f3f3;
      border-top: 2px solid #3498db;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      animation: spin 1s linear infinite;
      display: inline-block;
    }

    .small-p {
      font-size: 14px;
      margin-top: 5px;
    }
  </style>

</head>

<body class="is-loading">

  <!-- ‚úÖ NEW: Page Loader Overlay -->
  <div id="pageLoader">
    <div class="loader-card">
      <div class="ring"></div>
      <h2 class="loader-title">‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá‚Ä¶</h2>
      <p class="loader-sub">Firebase ‡¶•‡ßá‡¶ï‡ßá ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ü‡¶∏‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶∏‡¶¨ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶π‡¶æ‡¶á‡¶≤‡¶æ‡¶á‡¶ü ‡¶π‡ßü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá ‚úÖ</p>
    </div>
  </div>

  <div class="navbar">
    <div class="nav-inner">
      <span class="menu-icon" onclick="toggleSidebar(event)">‚ò∞</span>

      <div class="nav-title">
        <h1>‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</h1>
        <small>Balance & Transactions</small>
      </div>

      <div class="nav-badge">
        <span class="dot"></span>
        <span>Realtime Firebase</span>
      </div>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sb-card">
      <h3>üìå Quick Menu</h3>
      <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
    </div>
    <a href="index.html">üè† Dashboard</a>
    <a href="Dollar.html">üí∞ ‡¶°‡¶≤‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</a>
    <a href="Taka.html">üíµ ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</a>
  </div>

  <div class="cash-buttons">
    <button class="cash-in-btn" onclick="openForm('in')">üí≤Dollar in‚ûï</button>
    <button class="cash-out-btn" onclick="openForm('out')">üí≤Dollar Sell‚ûñ</button>
    <button class="c-convert" onclick="openForm('c-out')">Convertüí±</button>
    <button class="taka-transfar" onclick="openForm('t-out')">Banküè¶‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞</button>
  </div>

  <div class="main-content">
    <div class="cards-container">
      <div class="card card1">
        <p id="binance-dollar">$ 0.00</p>
        <h3>Binance Dollar</h3>
      </div>

      <div class="card card2">
        <p id="redot-dollar">$ 0.00</p>
        <h3>Redot-pay Dollar</h3>
      </div>

      <div class="card card3">
        <p id="total-cash">0.00 ‡ß≥</p>
        <h3>‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂</h3>
      </div>

      <div class="card card4">
        <p id="afridi-due">0.00 ‡ß≥</p>
        <h3>‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø ‡¶™‡¶æ‡¶¨‡ßá</h3>
      </div>

      <div class="card card5">
        <p id="bank-transfer">0.00 ‡ß≥</p>
        <h3>Banküè¶Transfer Today</h3>
      </div>

      <div class="card card6">
        <p id="today-charge">0.00 ‡ß≥</p>
        <h3>‡¶ö‡¶æ‡¶∞‡ßç‡¶ú</h3>
      </div>

      <div class="card card7">
        <p id="dollar-in-val">$ 0.00</p>
        <p class="small-p" id="dollar-in-taka">0.00 ‡ß≥</p>
        <h3>Dollar in today</h3>
      </div>

      <div class="card card8">
        <p id="dollar-out-val">$ 0.00</p>
        <p class="small-p" id="dollar-out-taka">0.00 ‡ß≥</p>
        <h3>Dollar out today</h3>
      </div>

      <div class="card card9">
        <p id="today-profit">0.00 ‡ß≥</p>
        <h3>today profit</h3>
      </div>
    </div>
  </div>

  <div id="formContainer" class="popup-form" style="display:none;">

    <div id="formIn" class="form-content" style="display:none;">
      <h1 class="dollarintext">Dollar in <span id="inEditTitle" style="font-size: 14px; font-weight: normal; color: #666;"></span></h1>
      <div class="row-line-type">
        <select class="account-type-b" id="incategory" required>
          <option>Binance</option>
          <option>Redot-pay</option>
        </select>

        <select class="account-type-b" id="inperson" required>
          <option>‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø </option>
          <option>‡¶¨‡¶æ‡¶π‡¶ø‡¶∞ ‡¶•‡ßá‡¶ï‡ßá</option>
        </select>
      </div>

      <div class="row-line-time">
        <div class="time-box">
          <span id="showTimeIn">--:-- AM</span>
          <input type="time" id="timePickerIn" class="hidden-picker"> <img src="time.png" class="icon" onclick="openTime('In')">
        </div>
        <div class="date-box">
          <span id="showDateIn"></span>
          <input type="date" id="datePickerIn" class="hidden-picker date-picker-fix"> <img src="calendar.png" class="icon" onclick="openDate('In')">
        </div>
      </div>

      <div class="row-line-ratbox">
        <label for="indollar">Dollar</label>
        <div class="dollar-input-container">
          <input type="number" id="indollar" class="dollar-box" placeholder="0.00">
          <span class="currency-symbol">$</span>
        </div>
        <label for="inrate">Rate</label>
        <div class="rate-input-container">
          <input type="number" id="inrate" class="rate-box" placeholder="0.00">
          <span class="currency-symbol">‡ß≥</span>
        </div>
      </div>

      <input type="text" id="inDescription" placeholder="‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶¶‡¶ø‡¶®">

      <div class="button-row">
        <button class="cancel-btn" onclick="closeForm()">Cancel</button>
        <button class="save-btn" onclick="saveIn()">Save</button>
      </div>
    </div>

    <div id="formOut" class="form-content" style="display:none;">
      <h1 class="dollarouttext">Dollar Out <span id="outEditTitle" style="font-size: 14px; font-weight: normal; color: #666;"></span></h1>

      <div class="row-line-time">
        <div class="time-box">
          <span id="showTimeOut">--:-- AM</span>
          <input type="time" id="timePickerOut" class="hidden-picker"> <img src="time.png" class="icon" onclick="openTime('Out')">
        </div>
        <div class="date-box">
          <span id="showDateOut"></span>
          <input type="date" id="datePickerOut" class="hidden-picker date-picker-fix"> <img src="calendar.png" class="icon" onclick="openDate('Out')">
        </div>
      </div>

      <div class="row-line-type">
        <select class="account-type-b" id="out_dollar_source" required>
          <option>Binance</option>
          <option>Redot-pay</option>
        </select>
      </div>

      <div class="row-line-type">
        <select class="account-type-a" id="out_taka_destination" required>
          <option>‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤</option>
          <option>‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü</option>
          <option>‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö‡ßá‡¶®‡ßç‡¶ü</option>
          <option>‡¶®‡¶ó‡¶¶ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤</option>
          <option>‡¶®‡¶ó‡¶¶ ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü</option>
          <option>‡¶∞‡¶ï‡ßá‡¶ü ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤ </option>
          <option>‡¶∞‡¶ï‡ßá‡¶ü ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü</option>
        </select>

        <input type="number" id="out_mobile_number" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ">
      </div>

      <div class="row-line-ratbox">
        <label for="out_dollar">Dollar</label>
        <div class="dollar-input-container">
          <input type="number" id="out_dollar" class="dollar-box" placeholder="0.00" readonly>
          <span class="currency-symbol">$</span>
        </div>
        <label for="out_rate">Rate</label>
        <div class="rate-input-container">
          <input type="number" id="out_rate" class="rate-box" placeholder="0.00" oninput="calculateDollarAmount()">
          <span class="currency-symbol">‡ß≥</span>
        </div>
      </div>

      <div class="row-line-charge-box">
        <label for="out_charge">Charge</label>
        <input type="number" id="out_charge" class="charge-box" placeholder="0.00 ‡ß≥" oninput="calculateDollarAmount()">
        <label for="total-L">Total</label>
        <input type="number" id="totalOutDisplay" class="total-box" placeholder="0.00 ‡ß≥" oninput="calculateDollarAmount()">
      </div>

      <input type="text" id="outDescription" placeholder="‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶¶‡¶ø‡¶®">
      </br>

      <div class="button-row">
        <button class="cancel-btn" onclick="closeForm()">Cancel</button>
        <button class="save-btn" onclick="saveOut()">Save</button>
      </div>
    </div>

    <div id="formConvert" class="form-contents" style="display:none;">
      <h1 class="converttext">Convert Taka <span id="convertEditTitle" style="font-size: 14px; font-weight: normal; color: #666;"></span></h1>
      <p style="color: #6c757d; font-size: 14px; margin-top: -15px;">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶è‡¶ï ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡¶æ‡¶®‡ßç‡¶§‡¶∞‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</p>

      <div class="row-line-type">
        <select class="account-type-a" id="convertFrom" required>
          <option>‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤</option>
          <option>‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü</option>
          <option>‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö‡ßá‡¶®‡ßç‡¶ü</option>
          <option>‡¶®‡¶ó‡¶¶ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤</option>
          <option>‡¶®‡¶ó‡¶¶ ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü</option>
          <option>‡¶∞‡¶ï‡ßá‡¶ü ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤ </option>
          <option>‡¶∞‡¶ï‡ßá‡¶ü ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü</option>
        </select>

        <select class="account-type-a" id="convertTo" required>
          <option>‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø ‡¶™‡¶æ‡¶¨‡ßá</option>
          <option>Banküè¶Transfer</option>
        </select>
      </div>

      <div class="row-line-time">
        <div class="time-box">
          <span id="showTimeConvert">--:-- AM</span>
          <input type="time" id="timePickerConvert" class="hidden-picker"> <img src="time.png" class="icon" onclick="openTime('Convert')">
        </div>
        <div class="date-box">
          <span id="showDateConvert"></span>
          <input type="date" id="datePickerConvert" class="hidden-picker date-picker-fix"> <img src="calendar.png" class="icon" onclick="openDate('Convert')">
        </div>
      </div>

      <div class="row-line-convert-taka">
        <label for="convertTakaAmount">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label>
        <input type="number" id="convertTakaAmount" class="tk-convert" placeholder="0.00 ‡ß≥" oninput="calculateTotalConvertTaka()">

        <label for="convertTakaCharge">Charge</label>
        <input type="number" id="convertTakaCharge" class="charge-box" placeholder="0.00 ‡ß≥" oninput="calculateTotalConvertTaka()">
      </div>

      <div style="width: 80%; margin: 10px auto;">
        <label for="convertTakaTotalDisplay" style="font-weight: 600; color: #333; font-size: 16px; display: block; margin-bottom: 5px;">Total</label>
        <div class="taka-total-box" id="convertTakaTotalDisplay">0.00 ‡ß≥</div>
      </div>

      <input type="text" id="convertDescription" placeholder="‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶¶‡¶ø‡¶® (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)">

      <div class="button-row">
        <button class="cancel-btn" onclick="closeForm()">Cancel</button>
        <button class="save-btn" onclick="saveConvert()">Save</button>
      </div>
    </div>

    <div id="formt-out" class="form-contents" style="display:none;">
      <h1 class="taka-transfar">Bank Transfer <span id="takaTransferEditTitle" style="font-size: 14px; font-weight: normal; color: #666;"></span></h1>

      <div class="row-line-type">
        <select class="account-type-a" id="takaFrom" required>
          <option>‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø ‡¶™‡¶æ‡¶¨‡ßá</option>
          <option>‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂</option>
        </select>

        <select class="account-type-a" id="takaTo" required>
          <option>Brack-Bank</option>
          <option>City-Bank</option>
        </select>
      </div>

      <div class="row-line-time">
        <div class="time-box">
          <span id="showTimeTransfer">--:-- AM</span>
          <input type="time" id="timePickerTransfer" class="hidden-picker"> <img src="time.png" class="icon" onclick="openTime('Transfer')">
        </div>
        <div class="date-box">
          <span id="showDateTransfer"></span>
          <input type="date" id="datePickerTransfer" class="hidden-picker date-picker-fix"> <img src="calendar.png" class="icon" onclick="openDate('Transfer')">
        </div>
      </div>

      <label class="taka-amount-label" for="takaAmount">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label>
      <input type="number" id="takaAmount" class="tk-transfer-amount" placeholder="0.00 ‡ß≥" required>

      <input type="text" id="takaDescription" placeholder="‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶¶‡¶ø‡¶®">

      <div class="button-row">
        <button class="cancel-btn" onclick="closeForm()">Cancel</button>
        <button class="save-btn" onclick="saveTakaTransfer()">Save</button>
      </div>
    </div>
  </div>

  <div class="row-line-show">

    <div class="date-boxs">
      <div id="dateFilterWrapper" class="date-filter-group">
        <button id="dateFilterBtn" class="filter-button" onclick="openDateRangeModal()">üìÖ</button>
        <button id="clearDateBtn" onclick="clearDateRange()" style="display: none;">‚ùå</button>
      </div>
    </div>

    <div id="dateRangeModal" class="popup-form" style="display:none;">
      <div class="form-content" style="max-width: 350px;">
        <h2 style="margin-top: 0;">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶∞‡ßá‡¶û‡ßç‡¶ú ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h2>

        <label for="startDateFilter">‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label>
        <input type="date" id="startDateFilter" style="margin-bottom: 15px;">

        <label for="endDateFilter">‡¶∂‡ßá‡¶∑ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label>
        <input type="date" id="endDateFilter">

        <div class="button-row" style="margin-top: 20px;">
          <button class="cancel-btn" onclick="document.getElementById('dateRangeModal').style.display='none'">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
          <button class="save-btn" onclick="setDateRangeAndFilter()">‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
      </div>
    </div>

    <select class="cg-select" id="categoryFilter" onchange="filterByCategory()">
      <option value="all">‡¶∏‡¶¨üåç</option>
      <option value="IN_ONLY">üí≤Dollar in‚ûï</option>
      <option value="OUT_ONLY">üí≤Dollar Sell‚ûñ</option>
      <option>Convertüí±</option>
      <option>Banküè¶‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞</option>
      <option>Binance</option>
      <option>Redot-pay</option>
      <option value="Profit/Loss">Profit/Loss</option>
    </select>

    <div class="table-rejalt" id="tableResultDisplay">0 ‡ß≥</div>

    <div class="column-toggle-container" style="position:relative;">
      <button id="toggleColumnsBtn">üëÅÔ∏è‚öôÔ∏è</button>

      <div id="columnDropdown" class="column-dropdown">
        <label><input type="checkbox" checked data-column="1"> No</label>
        <label><input type="checkbox" checked data-column="2"> Date</label>
        <label><input type="checkbox" checked data-column="3"> Time</label>
        <label><input type="checkbox" checked data-column="4">Category</label>
        <label><input type="checkbox" checked data-column="5">D. A/C</label>
        <label><input type="checkbox" checked data-column="6">Received A/C</label>
        <label><input type="checkbox" checked data-column="7">Number</label>
        <label><input type="checkbox" checked data-column="8">Charge</label>
        <label><input type="checkbox" checked data-column="9">Rate</label>
        <label><input type="checkbox" checked data-column="10">Dollar</label>
        <label><input type="checkbox" checked data-column="11">Amount</label>
        <label><input type="checkbox" checked data-column="12">Profit/Loss</label>
        <label><input type="checkbox" checked data-column="13">Details</label>
        <label><input type="checkbox" checked data-column="14">Action</label>
      </div>
    </div>
  </div>

  <div class="show-box">
    <div class="table-wrapper" id="tableWrapper">
      <div class="transaction-table-header">
        <div class="th-serial">No</div>
        <div class="th-date">Date</div>
        <div class="th-time">Time</div>
        <div class="th-category">Category</div>
        <div class="th-account">D. A/C</div>
        <div class="th-bank">Received A/C</div>
        <div class="th-number">Number</div>
        <div class="th-charge">Charge</div>
        <div class="th-rate">Rate</div>
        <div class="th-dollar">Dollar</div>
        <div class="th-amount">Amount</div>
        <div class="th-profit-loss">Profit/Loss</div>
        <div class="th-details">Details</div>
        <div class="th-action">Action</div>
      </div>

      <!-- ‚úÖ Old loader removed -->
      <div id="transactionBody"></div>
    </div>
  </div>

  <div class="page-size-area">
    <div class="pagination-controls"></div>

    <div class="page-size-control">
      <label for="rowsPerPageSelect">‡¶≤‡¶æ‡¶á‡¶® ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ:</label>
      <select id="rowsPerPageSelect" onchange="changeRowsPerPage(this.value)">
        <option value="10" selected>10</option>
        <option value="20">20</option>
        <option value="50">50</option>
        <option value="100">100</option>
      </select>
    </div>
  </div>

  <script type="module">
    // ‡¶´‡¶æ‡ßü‡¶æ‡¶∞‡¶¨‡ßá‡¶∏ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶á‡¶Æ‡¶™‡ßã‡¶∞‡ßç‡¶ü
    import { db } from './firebase-config.js';
    import { ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const transRef = ref(db, 'transactions');

    // ‡¶ó‡ßç‡¶≤‡ßã‡¶¨‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßá‡¶ü ‡¶≠‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡ßü‡ßá‡¶¨‡¶≤
    let isEditingIndex = null;
    let binanceDollar = 0;
    let redotDollar = 0;
    let totalCash = 0;
    let afridiPayable = 0;
    let bankTransferToday = 0; 
    let totalCharge = 0; 
    let totalDollarInventory = 0;
    let totalPurchaseCostInTaka = 0;
    let dailyProfitLoss = 0; 

    let dollarInToday = 0;
    let takaInToday = 0;
    let dollarOutToday = 0;
    let takaOutToday = 0; 

    let currentPage = 1;
    let currentRowsPerPage = 10; 

    let transactions = [];
    let dateFilterStart = null; 
    let dateFilterEnd = null;

    // ‚úÖ NEW: loader control
    let _firstLoadDone = false;

    // =======================================================
    // ‚úÖ ‡¶∏‡¶æ‡¶á‡¶°‡¶¨‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶®‡¶§‡ßÅ‡¶® ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá)
    // =======================================================
    window.toggleSidebar = function(event) {
      if (event) event.stopPropagation();
      const sidebar = document.getElementById('sidebar');
      if (sidebar) sidebar.classList.toggle('open');
    }

    // =======================================================
    // ‚úÖ ‡¶´‡¶∞‡ßç‡¶Æ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® (‡¶®‡¶§‡ßÅ‡¶® ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá)
    // =======================================================
    function resetAllForms() {
      const forms = ["formIn", "formOut", "formConvert", "formt-out"];
      forms.forEach(formId => {
        const formElement = document.getElementById(formId);
        if (formElement) {
          formElement.querySelectorAll('input').forEach(input => {
            if (input.type !== 'button' && input.type !== 'submit') input.value = '';
          });
          formElement.querySelectorAll('textarea').forEach(textarea => textarea.value = '');
          formElement.querySelectorAll('select').forEach(select => select.selectedIndex = 0);
        }
      });

      if(document.getElementById("totalOutDisplay")) document.getElementById("totalOutDisplay").value = "0.00";
      if(document.getElementById("convertTakaTotalDisplay")) document.getElementById("convertTakaTotalDisplay").textContent = "0.00 ‡ß≥";
    }

    function parseTime(timeStr) {
      if (!timeStr) return 0;
      const match = timeStr.match(/(\d+):(\d+)\s?(AM|PM)/i);
      if (!match) return 0;
      let hours = parseInt(match[1]);
      const minutes = parseInt(match[2]);
      const ampm = match[3].toUpperCase();
      if (ampm === 'PM' && hours !== 12) hours += 12;
      else if (ampm === 'AM' && hours === 12) hours = 0;
      return hours * 60 + minutes;
    }

    function sortTransactionsByDateTime() {
      transactions.sort((a, b) => {
        const dateA = a.date;
        const dateB = b.date;
        if (dateA < dateB) return -1;
        if (dateA > dateB) return 1;
        const timeValueA = parseTime(a.time);
        const timeValueB = parseTime(b.time);
        if (timeValueA < timeValueB) return -1;
        if (timeValueA > timeValueB) return 1;
        return 0;
      });
    }

    function saveTransactions() {
      set(transRef, transactions)
        .then(() => console.log("Saved to Firebase"))
        .catch((error) => alert("Error: " + error));
    }

    function finishPageLoadingOnce(){
      if (_firstLoadDone) return;
      _firstLoadDone = true;

      const loader = document.getElementById('pageLoader');
      if (loader) loader.style.display = 'none';

      document.body.classList.remove('is-loading');
      document.body.classList.add('is-loaded');
    }

    function loadTransactionsFromFirebase() {
      onValue(transRef, (snapshot) => {
        const data = snapshot.val();
        transactions = data ? (Array.isArray(data) ? data : Object.values(data)) : [];
        sortTransactionsByDateTime();
        recalculateBalances();
        displayTransactions();
        finishPageLoadingOnce();  // ‚úÖ NEW: hide loader + highlight
      });
    }

    // ‚úÖ NEW: number format with commas (5,000.00)
    const _fmt = new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    function comma2(n){
      const x = Number(n);
      if (isNaN(x) || !isFinite(x)) return _fmt.format(0);
      return _fmt.format(x);
    }

    function formatDollar(amount) {
      return '$ ' + comma2(amount);
    }
    function formatTaka(amount) {
      return comma2(amount) + ' ‡ß≥';
    }

    function recalculateBalances() {
      binanceDollar = 0; redotDollar = 0; totalCash = 0; afridiPayable = 0;
      bankTransferToday = 0; totalCharge = 0; totalDollarInventory = 0;
      totalPurchaseCostInTaka = 0; dailyProfitLoss = 0;
      dollarInToday = 0; takaInToday = 0; dollarOutToday = 0; takaOutToday = 0;

      const today = new Date().toISOString().split('T')[0];

      transactions.forEach(t => {
        if (t.type === 'in') {
          if (t.dollarAccount === 'Binance') binanceDollar += t.dollarAmount;
          else if (t.dollarAccount === 'Redot-pay') redotDollar += t.dollarAmount;
          totalDollarInventory += t.dollarAmount;
          totalPurchaseCostInTaka += t.takaAmount;
          if (t.date === today) { dollarInToday += t.dollarAmount; takaInToday += t.takaAmount; }
        } else if (t.type === 'out') {
          const cosg = t.costOfSoldGoods || 0;
          if (t.dollarAccount === 'Binance') binanceDollar -= t.dollarAmount;
          else if (t.dollarAccount === 'Redot-pay') redotDollar -= t.dollarAmount;
          totalDollarInventory -= t.dollarAmount;
          totalPurchaseCostInTaka -= cosg;
          totalCash += t.totalTakaReceived;
          totalCharge += t.charge;
          if (t.date === today) { dailyProfitLoss += t.profitLoss; dollarOutToday += t.dollarAmount; takaOutToday += t.totalTakaReceived; }
        } else if (t.type === 'convert') {
          const ded = t.takaAmount + t.charge;
          if (t.fromAccount === '‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂' || (t.fromAccount !== '‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø ‡¶™‡¶æ‡¶¨‡ßá' && t.fromAccount !== 'Banküè¶Transfer')) totalCash -= ded;
          totalCharge -= t.charge;
          if (t.toAccount === '‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø ‡¶™‡¶æ‡¶¨‡ßá') afridiPayable += t.takaAmount;
        } else if (t.type === 'transfer') {
          if (t.fromAccount === '‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø ‡¶™‡¶æ‡¶¨‡ßá') afridiPayable -= t.takaAmount;
          else if (t.fromAccount === '‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂') totalCash -= t.takaAmount;
          if (t.date === today) bankTransferToday += t.takaAmount;
        }
      });
      updateDashboardCards();
      updateTableResultDisplay();
    }

    function getFilteredTransactions() {
      const cat = document.getElementById('categoryFilter').value;
      return transactions.filter(t => {
        let categoryMatch = true;
        if (cat !== 'all') {
          if (cat === 'IN_ONLY') categoryMatch = t.type === 'in';
          else if (cat === 'OUT_ONLY') categoryMatch = t.type === 'out';
          else if (cat === 'Convertüí±') categoryMatch = t.type === 'convert';
          else if (cat === 'Banküè¶‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞') categoryMatch = t.type === 'transfer';
          else if (cat === 'Binance') categoryMatch = t.dollarAccount === 'Binance';
          else if (cat === 'Redot-pay') categoryMatch = t.dollarAccount === 'Redot-pay';
          else if (cat === 'Profit/Loss') categoryMatch = t.type === 'out';
          else categoryMatch = false;
        }
        let dateMatch = true;
        if (dateFilterStart && dateFilterEnd) {
          const tDate = new Date(t.date);
          const start = new Date(dateFilterStart);
          const end = new Date(dateFilterEnd);
          end.setDate(end.getDate() + 1);
          dateMatch = tDate >= start && tDate < end;
        }
        return categoryMatch && dateMatch;
      });
    }

    function updateTableResultDisplay() {
      const res = document.getElementById('tableResultDisplay');
      if (!res) return;
      const cat = document.getElementById('categoryFilter').value;
      const filtered = getFilteredTransactions();
      let total = 0;
      if (cat === 'all') { res.textContent = '0 ‡ß≥'; return; }
      if (cat === 'Profit/Loss') {
        filtered.forEach(t => { if (t.type === 'out') total += t.profitLoss; });
        res.textContent = formatTaka(total); return;
      }
      filtered.forEach(t => {
        if (t.type === 'in') total -= t.takaAmount;
        else if (t.type === 'out') total += t.totalTakaReceived;
        else if (t.type === 'convert') total -= (t.takaAmount + t.charge);
        else if (t.type === 'transfer') total -= t.takaAmount;
      });
      res.textContent = formatTaka(total);
    }

    function displayTransactions() {
      const body = document.getElementById('transactionBody');
      if (!body) return;

      const filtered = getFilteredTransactions();

      if (filtered.length === 0) {
        body.innerHTML = `
          <div style="text-align:center; padding:18px; color:#555; font-weight:700;">
            ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§
          </div>`;
        setupPagination();
        updateTableResultDisplay();
        return;
      }

      const totalPages = Math.ceil(filtered.length / currentRowsPerPage) || 1;
      if (currentPage > totalPages) currentPage = totalPages;
      const start = (currentPage - 1) * currentRowsPerPage;
      const end = start + currentRowsPerPage;

      const current = [...filtered].reverse().slice(start, end);

      body.innerHTML = current.map(t => {
        const idx = transactions.findIndex(ot =>
          ot.date === t.date &&
          ot.time === t.time &&
          ot.type === t.type &&
          ot.dollarAmount === t.dollarAmount
        );
        const serialNo = idx >= 0 ? (idx + 1) : '';
        return createTransactionRow(t, idx, serialNo);
      }).join('');

      setupPagination();
      updateTableResultDisplay();
    }

    function setupPagination() {
      const filtered = getFilteredTransactions();
      const totalPages = Math.ceil(filtered.length / currentRowsPerPage);
      const container = document.querySelector('.pagination-controls');
      if (!container) return;
      container.innerHTML = '';
      if (totalPages <= 1) return;

      const prev = createPaginationButton('<<', currentPage - 1);
      if (currentPage === 1) prev.classList.add('disabled-nav');
      container.appendChild(prev);

      for (let i = 1; i <= totalPages; i++) {
        const btn = createPaginationButton(i, i);
        if (i === currentPage) btn.classList.add('active-page');
        container.appendChild(btn);
      }

      const next = createPaginationButton('>>', currentPage + 1);
      if (currentPage === totalPages) next.classList.add('disabled-nav');
      container.appendChild(next);
    }

    function createPaginationButton(text, page) {
      const link = document.createElement('a');
      link.innerText = text; link.href = '#'; link.classList.add('page-link');
      link.onclick = (e) => { e.preventDefault(); changePage(page); };
      return link;
    }

    function changePage(page) {
      const total = Math.ceil(getFilteredTransactions().length / currentRowsPerPage);
      if (page >= 1 && page <= total) { currentPage = page; displayTransactions(); }
    }

    // Window Functions
    window.editTransaction = (index) => editTransaction(index);
    window.deleteTransaction = (index) => deleteTransaction(index);
    window.saveIn = () => saveIn();
    window.saveOut = () => saveOut();
    window.saveConvert = () => saveConvert();
    window.saveTakaTransfer = () => saveTakaTransfer();
    window.closeForm = () => closeForm();
    window.openForm = (type) => openForm(type);
    window.openTime = (type) => openTime(type);
    window.openDate = (type) => openDate(type);
    window.setAutoTime = (type) => setAutoTime(type);
    window.setAutoDate = (type) => setAutoDate(type);
    window.calculateDollarAmount = () => calculateDollarAmount();
    window.calculateTotalConvertTaka = () => calculateTotalConvertTaka();
    window.filterByCategory = () => { currentPage = 1; displayTransactions(); };
    window.changeRowsPerPage = (val) => { currentRowsPerPage = parseInt(val); currentPage = 1; displayTransactions(); };
    window.setDateRangeAndFilter = () => setDateRangeAndFilter();
    window.clearDateRange = () => clearDateRange();

    function createTransactionRow(t, index, serialNo) {
      let cat = 'N/A', acc = 'N/A', recv = 'N/A', mob = 'N/A', chg = 0, rat = 0, dol = 0, amt = '0 ‡ß≥', prof = 'N/A', cls = '';
      let dateDisp = t.date.split('-').reverse().join('/').replace(/^\d{4}/, t.date.slice(2, 4));

      if (t.type === 'in') {
        cat = 'Dollar In'; acc = t.dollarAccount; recv = t.person === '‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø ' ? '‡¶Ü‡¶´‡ßç‡¶∞‡¶ø‡¶¶‡¶ø ‡¶™‡¶æ‡¶¨‡ßá' : '‡¶¨‡¶æ‡¶π‡¶ø‡¶∞ ‡¶•‡ßá‡¶ï‡ßá';
        rat = t.rate; dol = t.dollarAmount; amt = formatTaka(t.takaAmount); cls = 'amount-out';
      } else if (t.type === 'out') {
        cat = 'Dollar Sell'; acc = t.dollarAccount; recv = t.takaAccount || 'null'; mob = t.mobileNumber || 'N/A';
        chg = t.charge; rat = t.rate; dol = t.dollarAmount; amt = formatTaka(t.totalTakaReceived); cls = 'amount-in';
        prof = `<span style="color: ${t.profitLoss >= 0 ? 'green' : 'red'};">${formatTaka(t.profitLoss)}</span>`;
      } else if (t.type === 'convert') {
        cat = 'Taka Convert'; acc = t.fromAccount; recv = t.toAccount; chg = t.charge; amt = formatTaka(t.takaAmount); cls = 'amount-out';
      } else if (t.type === 'transfer') {
        cat = 'Bank Transfer'; acc = t.fromAccount; recv = t.toAccount; amt = formatTaka(t.takaAmount); cls = 'amount-out';
      }

      return `
        <div class="transaction-item">
          <div class="td-serial">${serialNo}</div>
          <div class="td-date">${dateDisp}</div><div class="td-time">${t.time}</div>
          <div class="td-category">${cat}</div><div class="td-account">${acc}</div>
          <div class="td-bank">${recv}</div><div class="td-number">${mob}</div>
          <div class="td-charge">${comma2(chg)}</div><div class="td-rate">${rat ? comma2(rat) : 'N/A'}</div>
          <div class="td-dollar">${dol ? comma2(dol) : 'N/A'}</div><div class="td-amount ${cls}">${amt}</div>
          <div class="td-profit-loss">${prof}</div><div class="td-details">${t.description || 'Null'}</div>
          <div class="td-action action-buttons">
            <button class="edit-btn" onclick="editTransaction(${index})">‚úèÔ∏è</button>
            <button class="delete-btn" onclick="deleteTransaction(${index})">üóëÔ∏è</button>
          </div>
        </div>`;
    }

    function deleteTransaction(index) {
      if (confirm("‡¶≤‡ßá‡¶®‡¶¶‡ßá‡¶®‡¶ü‡¶ø ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) { transactions.splice(index, 1); saveTransactions(); }
    }

    function editTransaction(index) {
      isEditingIndex = index;
      const t = transactions[index];
      resetAllForms();
      if (t.type === 'in') {
        openForm('in'); document.getElementById('incategory').value = t.dollarAccount;
        document.getElementById('inperson').value = t.person; document.getElementById('indollar').value = t.dollarAmount;
        document.getElementById('inrate').value = t.rate; document.getElementById('inDescription').value = t.description || '';
        document.getElementById('showTimeIn').textContent = t.time; document.getElementById('showDateIn').textContent = t.date;
        document.getElementById('datePickerIn').value = t.date;
      } else if (t.type === 'out') {
        openForm('out'); document.getElementById('out_dollar_source').value = t.dollarAccount;
        document.getElementById('out_taka_destination').value = t.takaAccount; document.getElementById('out_mobile_number').value = t.mobileNumber;
        document.getElementById('out_dollar').value = t.dollarAmount; document.getElementById('out_rate').value = t.rate;
        document.getElementById('out_charge').value = t.charge; document.getElementById('totalOutDisplay').value = t.totalTakaReceived;
        document.getElementById('outDescription').value = t.description || '';
        document.getElementById('showTimeOut').textContent = t.time; document.getElementById('showDateOut').textContent = t.date;
        document.getElementById('datePickerOut').value = t.date;
      } else if (t.type === 'convert') {
        openForm('c-out'); document.getElementById('convertFrom').value = t.fromAccount;
        document.getElementById('convertTo').value = t.toAccount; document.getElementById('convertTakaAmount').value = t.takaAmount;
        document.getElementById('convertTakaCharge').value = t.charge; calculateTotalConvertTaka();
      } else if (t.type === 'transfer') {
        openForm('t-out'); document.getElementById('takaFrom').value = t.fromAccount;
        document.getElementById('takaTo').value = t.toAccount; document.getElementById('takaAmount').value = t.takaAmount;
      }
    }

    function saveIn() {
      const dol = parseFloat(document.getElementById('indollar').value) || 0;
      const rat = parseFloat(document.getElementById('inrate').value) || 0;
      if (dol <= 0 || rat <= 0) return alert("‡¶Æ‡¶æ‡¶® ‡¶¶‡¶ø‡¶®");
      const nt = { type: 'in', date: document.getElementById('datePickerIn').value, time: document.getElementById('showTimeIn').textContent, dollarAccount: document.getElementById('incategory').value, person: document.getElementById('inperson').value, dollarAmount: dol, rate: rat, takaAmount: dol * rat, description: document.getElementById('inDescription').value.trim() };
      if (isEditingIndex !== null) transactions[isEditingIndex] = nt; else transactions.push(nt);
      saveTransactions(); closeForm();
    }

    function saveOut() {
      const dol = parseFloat(document.getElementById('out_dollar').value) || 0;
      const rat = parseFloat(document.getElementById('out_rate').value) || 0;
      const tot = parseFloat(document.getElementById('totalOutDisplay').value) || 0;
      const chg = parseFloat(document.getElementById('out_charge').value) || 0;
      if (dol <= 0 || rat <= 0) return alert("‡¶Æ‡¶æ‡¶® ‡¶¶‡¶ø‡¶®");
      let tDol = totalDollarInventory, tCos = totalPurchaseCostInTaka;
      if (isEditingIndex !== null && transactions[isEditingIndex].type === 'out') { tCos += transactions[isEditingIndex].costOfSoldGoods; tDol += transactions[isEditingIndex].dollarAmount; }
      const avg = tDol > 0 ? tCos / tDol : 0;
      const cosg = dol * avg;
      const nt = { type: 'out', date: document.getElementById('datePickerOut').value, time: document.getElementById('showTimeOut').textContent, dollarAccount: document.getElementById('out_dollar_source').value, takaAccount: document.getElementById('out_taka_destination').value, mobileNumber: document.getElementById('out_mobile_number').value, dollarAmount: dol, rate: rat, charge: chg, totalTakaReceived: tot, profitLoss: (tot - chg) - cosg, costOfSoldGoods: cosg, description: document.getElementById('outDescription').value.trim() };
      if (isEditingIndex !== null) transactions[isEditingIndex] = nt; else transactions.push(nt);
      saveTransactions(); closeForm();
    }

    function saveConvert() {
      const amt = parseFloat(document.getElementById('convertTakaAmount').value) || 0;
      const nt = { type: 'convert', date: document.getElementById('datePickerConvert').value, time: document.getElementById('showTimeConvert').textContent, fromAccount: document.getElementById('convertFrom').value, toAccount: document.getElementById('convertTo').value, takaAmount: amt, charge: parseFloat(document.getElementById('convertTakaCharge').value) || 0, description: document.getElementById('convertDescription').value.trim() };
      if (isEditingIndex !== null) transactions[isEditingIndex] = nt; else transactions.push(nt);
      saveTransactions(); closeForm();
    }

    function saveTakaTransfer() {
      const amt = parseFloat(document.getElementById('takaAmount').value) || 0;
      const nt = { type: 'transfer', date: document.getElementById('datePickerTransfer').value, time: document.getElementById('showTimeTransfer').textContent, fromAccount: document.getElementById('takaFrom').value, toAccount: document.getElementById('takaTo').value, takaAmount: amt, description: document.getElementById('takaDescription').value.trim() };
      if (isEditingIndex !== null) transactions[isEditingIndex] = nt; else transactions.push(nt);
      saveTransactions(); closeForm();
    }

    function updateDashboardCards() {
      const cards = ['.card1 p', '.card2 p', '.card3 p', '.card4 p', '.card5 p', '.card6 p', '.card9 p'];
      const vals = [formatDollar(binanceDollar), formatDollar(redotDollar), formatTaka(totalCash), formatTaka(afridiPayable), formatTaka(bankTransferToday), formatTaka(totalCharge), formatTaka(dailyProfitLoss)];
      cards.forEach((c, i) => { const el = document.querySelector(c); if(el) el.textContent = vals[i]; });
      const c7 = document.querySelector('.card7'); if(c7){ c7.querySelectorAll('p')[0].textContent = formatDollar(dollarInToday); c7.querySelectorAll('p')[1].textContent = formatTaka(takaInToday); }
      const c8 = document.querySelector('.card8'); if(c8){ c8.querySelectorAll('p')[0].textContent = formatDollar(dollarOutToday); c8.querySelectorAll('p')[1].textContent = formatTaka(takaOutToday); }
    }

    function setAutoTime(type) {
      const now = new Date();
      let h = now.getHours(), m = String(now.getMinutes()).padStart(2, '0'), ampm = h >= 12 ? 'PM' : 'AM';
      document.getElementById('showTime' + type).textContent = `${h % 12 || 12}:${m} ${ampm}`;
      document.getElementById('timePicker' + type).value = `${String(h).padStart(2, '0')}:${m}`;
    }

    function setAutoDate(type) {
      const d = new Date().toISOString().split('T')[0];
      document.getElementById('datePicker' + type).value = d;
      document.getElementById('showDate' + type).textContent = d;
    }

    function openTime(type) {
      const inp = document.getElementById('timePicker' + type); inp.click();
      inp.onchange = () => { let [h, m] = inp.value.split(':'), hh = parseInt(h); document.getElementById('showTime' + type).textContent = `${hh % 12 || 12}:${m} ${hh >= 12 ? 'PM' : 'AM'}`; };
    }

    function openDate(type) {
      const inp = document.getElementById('datePicker' + type); inp.click();
      inp.onchange = () => document.getElementById('showDate' + type).textContent = inp.value;
    }

    function calculateDollarAmount() {
      const tot = parseFloat(document.getElementById('totalOutDisplay').value) || 0,
            rat = parseFloat(document.getElementById('out_rate').value) || 0,
            chg = parseFloat(document.getElementById('out_charge').value) || 0;
      document.getElementById('out_dollar').value = (rat > 0 ? (tot - chg) / rat : 0).toFixed(2);
    }

    function calculateTotalConvertTaka() {
      const a = parseFloat(document.getElementById('convertTakaAmount').value) || 0,
            c = parseFloat(document.getElementById('convertTakaCharge').value) || 0;
      document.getElementById('convertTakaTotalDisplay').textContent = comma2(a + c) + ' ‡ß≥';
    }

    function openForm(type) {
      resetAllForms();
      document.getElementById("formContainer").style.display = "flex";
      ["formIn", "formOut", "formConvert", "formt-out"].forEach(id => document.getElementById(id).style.display = "none");
      if (type === "in") { document.getElementById("formIn").style.display = "block"; setAutoTime('In'); setAutoDate('In'); }
      else if (type === "out") { document.getElementById("formOut").style.display = "block"; setAutoTime('Out'); setAutoDate('Out'); }
      else if (type === "c-out") { document.getElementById("formConvert").style.display = "block"; setAutoTime('Convert'); setAutoDate('Convert'); }
      else if (type === "t-out") { document.getElementById("formt-out").style.display = "block"; setAutoTime('Transfer'); setAutoDate('Transfer'); }
    }

    function closeForm() {
      document.getElementById("formContainer").style.display = "none";
      resetAllForms();
      isEditingIndex = null;
    }

    function setDateRangeAndFilter() {
      dateFilterStart = document.getElementById('startDateFilter').value;
      dateFilterEnd = document.getElementById('endDateFilter').value;
      currentPage = 1; displayTransactions();
    }

    function clearDateRange() {
      dateFilterStart = dateFilterEnd = null;
      currentPage = 1; displayTransactions();
    }

    // ‚úÖ Column toggle UI (safe)
    function setupColumnToggle(){
      const btn = document.getElementById('toggleColumnsBtn');
      const dd = document.getElementById('columnDropdown');
      const wrap = document.getElementById('tableWrapper');
      if (!btn || !dd || !wrap) return;

      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        dd.style.display = (dd.style.display === 'block') ? 'none' : 'block';
      });

      document.addEventListener('click', () => { dd.style.display = 'none'; });

      dd.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', () => {
          const col = cb.getAttribute('data-column');
          if (!col) return;
          const cls = 'hidden-col-' + col;
          if (cb.checked) wrap.classList.remove(cls);
          else wrap.classList.add(cls);
        });
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      setupColumnToggle();
      loadTransactionsFromFirebase();
    });
  </script>

</body>
</html>
